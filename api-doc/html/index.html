<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.6"/>
<title>thing-if SDK: Main Page</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">thing-if SDK
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.6 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li class="current"><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Macros</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">thing-if SDK Documentation</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>Thing SDK for Kii Thing Interaction Framework (kii thing-if) .<br/>
</p>
<h2>Retrieve submodules.</h2>
<p>When you build this SDK for the first time, you need to execute following commands:</p>
<p>```sh </p>
<h1>git submodule init</h1>
<h1>git submodule update</h1>
<h1>cd kii</h1>
<h1>git submodule init</h1>
<h1>git submodule update</h1>
<h1>cd ../</h1>
<p>```</p>
<p>These commands retrieve required modules for this SDK.</p>
<h2>Build</h2>
<p>```sh $ mkdir build $ cd build $ cmake ../ $ make ```</p>
<h3>Install</h3>
<p>After the build, you can install SDK libraries by following commands. (Assume current directory is build you've created on build.)</p>
<p>```sh $ make install ```</p>
<p>Or if you want to change install location:</p>
<p>```sh $ make DESTDIR={path to install} install ```</p>
<p>By specifying <code>DESTDIR</code>, libraries and headers are installed in {path to install}/usr/local/lib and {path to install}/usr/local/include respectively.</p>
<h3>Build Configuration</h3>
<h4>Debug Build</h4>
<p>If you need to enable -g option and debug log output, following command will generate the debug build.</p>
<p>```sh $ mkdir build $ cd build $ cmake -DCMAKE_BUILD_TYPE=DEBUG ../ $ make ```</p>
<h4>Configure MQTT keep-alive interval</h4>
<p>Edit CMakeLists.txt and change following line.</p>
<p>``` SET(CMAKE_C_FLAGS "-DKII_PUSH_KEEP_ALIVE_INTERVAL_SECONDS=300") ```</p>
<p>Unit is seconds and by default it is set to 300 seconds. If 0 is specified, turn off the keep alive mechanism defined in MQTT. Setting short period will increase the load of MQTT broker when there is a lot of connected devices. For details, please refer to the <a href="http://docs.oasis-open.org/mqtt/mqtt/v3.1.1/os/mqtt-v3.1.1-os.html#_Toc385349238">MQTT spec</a>.</p>
<h4>Configure memory used by JSON parser.</h4>
<p>Edit CMakeLists.txt and change following line.</p>
<p>``` SET(CMAKE_C_FLAGS "-DKII_JSON_FIXED_TOKEN_NUM=128") ```</p>
<p>The number indicates amounts of memory used to parse JSON when received it from server. Memory is allocated on stack. By default it is set to 128. Size of memory allocated by this can be calculated as following.</p>
<p>```c sizeof(kii_json_token_t) * KII_JSON_FIXED_TOKEN_NUM ```</p>
<h4>Dynamic memory allocation for JSON parsing</h4>
<p>If you prefer to dynamic allocation than fixed memory allocation, Edit CMakeLists.txt and remove the line specifies <code>KII_JSON_FIXED_TOKEN_NUM</code>.</p>
<p>In this case, you need to implement <code>KII_JSON_RESOURCE_CB</code> function and set the pointer in <code>kii_t</code> struct.</p>
<h4>Connect MQTT server using non-secure connection.</h4>
<p>By default SDK connect to a MQTT broker using secure connection(tls). If you need to use non-secure connection(tcp), Edit CMakeLists.txt and enable following line. (By removing # in the head.)</p>
<p>``` SET(CMAKE_C_FLAGS "-DKII_MQTT_USE_PORT_TCP=1") ```</p>
<h2>How to use</h2>
<h3>Sample</h3>
<p><a href="./linux-sample">linux-sample</a> shows how to implement the client application works in the Thing.</p>
<h3>Environment implementations</h3>
<p>SDK requires application to implement callback functions.</p>
<h4>Socket callback functions:</h4>
<p>To communucate with server, socket API implmementation is required. Please refer to <a href="./linux-sample/sys_cb_impl.h">linux-sample/sys\_cb\_impl.h</a> and <a href="./linux-sample/sys_cb_linux.c">linux-sample/sys\_cb\_linux.c</a></p>
<p>Actual implementations are in <a href="./linux-sample/linux-env">linux-env</a> directory.</p>
<h4>Task callback functions:</h4>
<p>To handle tasks asynchronusly, task implementation is required. <code>pthread</code> live up to expectation in linux environment and <code>task</code> does in RTOS environments.</p>
<p>List of task name symbols.</p>
<ul>
<li><p class="startli"><code>KII_THING_IF_TASK_NAME_UPDATE_STATUS</code></p>
<p class="startli">The task of sending onboarded status.</p>
</li>
<li><p class="startli"><code>KII_TASK_NAME_RECV_MSG</code></p>
<p class="startli">The task of receiving push messages.</p>
</li>
<li><p class="startli"><code>KII_TASK_NAME_PING_REQ</code></p>
<p class="startli">The task of sending ping request.</p>
</li>
</ul>
<p>In RTOS, You'll specify stack size, depth and priority, etc depending on the environment.</p>
<h2>Execute tests</h2>
<p>```sh </p>
<h1>cd tests/small_tests</h1>
<h1>make test</h1>
<p>``` </p>
</div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Fri Mar 16 2018 02:28:43 for thing-if SDK by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.6
</small></address>
</body>
</html>
