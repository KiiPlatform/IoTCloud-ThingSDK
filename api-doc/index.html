<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.12"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>thing-if SDK: Kii thing-if SDK for Thing</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">thing-if SDK
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.12 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">Kii thing-if SDK for Thing </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>Thing SDK for Kii Thing Interaction Framework (kii thing-if) .<br />
</p>
<h2>Retrieve submodules.</h2>
<p>When you build this SDK for the first time, you need to execute following commands:</p>
<div class="fragment"><div class="line"># git submodule init</div><div class="line"># git submodule update</div><div class="line"># cd kii</div><div class="line"># git submodule init</div><div class="line"># git submodule update</div><div class="line"># cd ../</div></div><!-- fragment --><p>These commands retrieve required modules for this SDK.</p>
<h2>Build</h2>
<div class="fragment"><div class="line"># make</div></div><!-- fragment --><p>This makes libkiithingifsdk.so.</p>
<p>## Debug Build </p><div class="fragment"><div class="line"># make DEBUG=1</div></div><!-- fragment --><p>Standard build for debugging.</p>
<ul>
<li>KII_PUSH_KEEP_ALIVE_INTERVAL_SECONDS is set to 300 seconds.</li>
<li>KII_JSON_FIXED_TOKEN_NUM is set to 128.</li>
<li>Debug option (-g) and Debug log enabled.</li>
</ul>
<h2>Configure KII_PUSH_KEEP_ALIVE_INTERVAL_SECONDS</h2>
<p>KII_PUSH_KEEP_ALIVE_INTERVAL_SECONDS macro is used to manage the Keep Alive Time Interval in MQTT. By default it is set to 300 seconds in the Makefile. To override the value, we provides <code>KEEP_ALIVE_INTERVAL</code> variable.</p>
<div class="fragment"><div class="line"># make KEEP_ALIVE_INTERVAL=600</div></div><!-- fragment --><p>If 0 is specified, turn off the keep alive mechanism defined in MQTT. Setting short period will increase the load of MQTT broker when there is a lot of connected devices. For details, please refer to the <a href="http://docs.oasis-open.org/mqtt/mqtt/v3.1.1/os/mqtt-v3.1.1-os.html#_Toc385349238">MQTT spec</a>.</p>
<h2>Configure KII_JSON_FIXED_TOKEN_NUM</h2>
<p>KII_JSON_FIXED_TOKEN_NUM macro is used to manage amount memory used to parse JSON when received it from server. Memory is allocated on stack. By default it is set to 128 in the Makefile. To override the value, we provides <code>FIXED_JSON_TOKEN_NUM</code> variable.</p>
<div class="fragment"><div class="line"># make FIXED_JSON_TOKEN_NUM=256</div></div><!-- fragment --><p>Size of memory allocated by this can be calculated as following. </p><div class="fragment"><div class="line"><span class="keyword">sizeof</span>(kii_json_token_t) * KII_JSON_FIXED_TOKEN_NUM</div></div><!-- fragment --> <h2>Dynamic memory allocation for JSON parsing</h2>
<p>If you prefer to dynamica allocation than fixed memory allocation by KII_JSON_FIXED_TOKEN_NUM, You will build sdk with FLEXIBLE_JSON_TOKEN variable.</p>
<div class="fragment"><div class="line"># make FLEXIBLE_JSON_TOKEN=1</div></div><!-- fragment --><p>In this case, you need to implement KII_JSON_RESOURCE_CB function and set the pointer in kii_t struct.</p>
<p>If both KII_JSON_FIXED_TOKEN_NUM and FLEXIBLE_JSON_TOKEN are specified, KII_JSON_FIXED_TOKEN_NUM is ignored.</p>
<h2>Connect MQTT server using non-secure connection.</h2>
<p>By default SDK connect to a MQTT broker using secure connection(tls). If you need to use non-secure connection(tcp) , please set KII_MQTT_USE_PORT_TCP macro.</p>
<div class="fragment"><div class="line"># make KII_MQTT_USE_PORT_TCP=1</div></div><!-- fragment --><h2>Combination of variables</h2>
<p>Only KII_JSON_FIXED_TOKEN_NUM and FLEXIBLE_JSON_TOKEN is exclusive. DEBUG, KEEP_ALIVE_INTERVAL, KII_MQTT_USE_PORT_TCP and either KII_JSON_FIXED_TOKEN_NUM or FLEXIBLE_JSON_TOKEN can be combined.</p>
<p>ex.)</p>
<div class="fragment"><div class="line"># make DEBUG=1 KEEP_ALIVE_INTERVAL=3600 KII_MQTT_USE_PORT_TCP=1 FLEXIBLE_JSON_TOKEN=1</div></div><!-- fragment --><h2>How to use</h2>
<p>After the build finished, API Documentation is created under ./doc/html/index.html</p>
<h2>Sample</h2>
<p>linux-sample shows how to implement the client application works in the Thing.</p>
<h2>Environment implementations</h2>
<p>This SDK requests creating three tasks by task_create_cb_impl callback.</p>
<p>List of task name symbols.</p>
<ul>
<li><p class="startli">KII_THING_IF_TASK_NAME_UPDATE_STATUS</p>
<p class="startli">The task of sending onboarded status.</p>
</li>
<li><p class="startli">KII_TASK_NAME_RECV_MSG</p>
<p class="startli">The task of receiving push messages.</p>
</li>
<li><p class="startli">KII_TASK_NAME_PING_REQ</p>
<p class="startli">The task of sending ping request.</p>
</li>
</ul>
<p>You'll specify stack size, depth and priority, etc depending on the environment. Please check samples for reference. For example, <a href="./cc3200-sample/freertos_thingsdk_demo/kii_thing_if_environment_cc3200.c">Ti CC3200 environment implementation</a>. </p>
</div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Thu Jan 26 2017 19:25:09 for thing-if SDK by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.12
</small></address>
</body>
</html>
